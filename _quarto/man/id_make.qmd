## Create data to run IRT model {.unnumbered}


### Description

To run an IRT model using <code>idealstan</code>, you must first process your data using the <code>id_make</code> 
function.



### Usage

<pre><code class='language-R'>id_make(
  score_data = NULL,
  outcome_disc = "outcome_disc",
  outcome_cont = "outcome_cont",
  person_id = "person_id",
  item_id = "item_id",
  time_id = "time_id",
  group_id = "group_id",
  model_id = "model_id",
  ordered_id = "ordered_id",
  ignore_id = "ignore_id",
  simul_data = NULL,
  person_cov = NULL,
  item_cov = NULL,
  item_cov_miss = NULL,
  remove_cov_int = FALSE,
  unbounded = FALSE,
  exclude_level = NA,
  simulation = FALSE
)
</code></pre>


### Arguments

<table>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="score_data">score_data</code></td>
<td>
A data frame in long form, i.e., one row in the data for each 
measured score or vote in the data or a <code>rollcall</code> data object from package <code>pscl</code>.
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="person_id">person_id</code></td>
<td>
Column name of the person/legislator ID index in <code>score_data</code>, 
default is <code>'person_id'</code>. Should be integer, character or factor.
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="item_id">item_id</code></td>
<td>
Column name of the item/bill ID index in <code>score_data</code>, 
default is <code>'item_id'</code>.  Should be integer, character or factor.
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="time_id">time_id</code></td>
<td>
Column name of the time values in <code>score_data</code>: 
optional, default is <code>'time_id'</code>. Should be a date or date-time class, but can be an integer
(i.e., years in whole numbers).
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="group_id">group_id</code></td>
<td>
Optional column name of a person/legislator group IDs (i.e., parties) in <code>score_data</code>. 
Optional, default is <code>'group_id'</code>. Should be integer, character or factor.
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="model_id">model_id</code></td>
<td>
Column name of the model/response types in the data.
Default is <code>"model_id"</code>. Only necessary if a model with multiple 
response types (i.e., binary + continuous outcomes). Must be a 
column with a series
of integers matching the model types in <code>id_estimate</code> 
showing which row of the data matches which outcome.
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="simul_data">simul_data</code></td>
<td>
Optionally, data that has been generated by the <code>id_sim_gen</code> function.
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="person_cov">person_cov</code></td>
<td>
A one-sided formula that specifies the covariates
in <code>score_data</code> that will be used to hierarchically model the person/legislator ideal points
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="item_cov">item_cov</code></td>
<td>
A one-sided formula that specifies the covariates
in <code>score_data</code> that will be used to hierarchically model the 
item/bill discrimination parameters for the regular model
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="item_cov_miss">item_cov_miss</code></td>
<td>
A one-sided formula that specifies the covariates
in the dataset that will be used to hierarchically model the item/bill discrimination parameters for the
missing data model.
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="remove_cov_int">remove_cov_int</code></td>
<td>
Whether to remove constituent terms from hierarchical covariates that 
interact covariates with IDs like <code>person_id</code> or <code>item_id</code>. Set to <code>TRUE</code> if
including these constituent terms would cause multi-collinearity with other terms in the model
(such as running a group-level model with a group-level interaction or a person-level model
with a person-level interaction).
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="unbounded">unbounded</code></td>
<td>
Whether or not the outcome/response is unbounded (i.e., continuous or
Poisson). If it is, <code>miss_val</code> 
is recoded as the maximum of the outcome + 1.
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="exclude_level">exclude_level</code></td>
<td>
A vector of any values that should be treated as <code>NA</code> in the response matrix. 
Unlike the <code>miss_val</code> parameter, these values will be dropped from the data before 
estimation rather than modeled explicitly.
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="simulation">simulation</code></td>
<td>
If <code>TRUE</code>, simulated values are saved in the <code>idealdata</code> object for 
later plotting with the <code>id_plot_sims</code> function
</td></tr>
<tr><td style = "white-space: nowrap; font-family: monospace; vertical-align: top"><code id="outcome">outcome</code></td>
<td>
Column name of the outcome in <code>score_data</code>, default is <code>"outcome"</code>
</td></tr>
</table>


### Details

This function can accept either a <code>rollcall</code> data object from package
<code>pscl</code> or 
a long data frame where one row equals one item-person (bill-legislator)
observation with associated outcome. The preferred method is the long data frame 
as passing a long data frame permits
the inclusion of a wide range of covariates in the model, such as person-varying and item-varying 
(bill-varying) covariates. 
If a <code>rollcall</code> object is passed to the function, the <code>rollcall</code> data is converted
to a long data frame with data from the <code>vote.data</code> matrix used to determine dates for bills.
If passing a long data frame, you should specify the names of the 
columns containing the IDs for persons, items and 
groups (groups are IDs that may have multiple observations per ID, such as political parties or
classes) to the <code>id_make</code> function, along with the name of the response/outcome. 
The only required columns are the item/bill ID and the person/legislator ID along with an 
outcome column. 

The preferred format for the outcome column for discrete variables (binary or ordinal)
is to pass a factor variable with levels in the correct order, i.e., in ascending order.
For example, if using legislative data, the levels of the factor should be <code>c('No','Yes')</code>.
If a different kind of variable is passed, such as a character or numeric variable, 
you should consider specifying <code>low_val</code>,<code>high_val</code> and <code>middle_val</code> to 
determine the correct order of the discrete outcome. Specifying <code>middle_val</code> is only
necessary if you are estimating an ordinal model.

If you do not specify a value for <code>miss_val</code>, then any <code>NA</code> are assumed to be 
missing. If you do specify <code>miss_val</code> and you also have <code>NA</code> in your data 
(assuming <code>miss_val</code> is not <code>NA</code>), then the function will treat the data
coded as <code>miss_val</code> as missing data that should be modeled and will treat the <code>NA</code>
data as ignorable missing data that will be removed (list-wise deletion) before estimating a
model.



### Value

A <code>idealdata</code> object that can then be used in the <code>id_estimate</code> function 
to fit a model.



### Examples
```{r, warning=FALSE, message=FALSE, eval=TRUE}
library(idealstan)

# You can either use a pscl rollcall object or a vote/score matrix 
# where persons/legislators are in the rows
# and items/bills are in the columns

library(dplyr)

# First, using a rollcall object with the 114th Senate's rollcall votes:

data('senate114')

to_idealstan <-   id_make(score_data = senate114,
               outcome_disc = 'cast_code',
               person_id = 'bioname',
               item_id = 'rollnumber',
               group_id= 'party_code',
               time_id='date')



```
