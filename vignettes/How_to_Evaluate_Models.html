<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Robert Kubinec" />

<meta name="date" content="2018-10-27" />

<title>How to Evaluate Models</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">How to Evaluate Models</h1>
<h4 class="author"><em>Robert Kubinec</em></h4>
<h4 class="date"><em>2018-10-27</em></h4>



<p>A big part of the purpose of <code>idealstan</code> is to give people different options in fitting ideal point models to diverse data. Along with that, <code>idealstan</code> makes use of Bayesian model evaluation a la <a href="https://CRAN.R-project.org/package=loo/vignettes/loo-example.html">loo</a> and also can analyze the posterior predictive distribution using <a href="http://mc-stan.org/users/interfaces/bayesplot">bayesplot</a>. <code>loo</code> is an approximation of the predictive error of a Bayesian model via leave-one-out cross-validation (LOO-CV). True LOO-CV on Bayesian models is computationally prohibitive because it involves estimating a new model for each data point. For IRT models incorporating thousands or even millions of observations, this is practically infeasible.</p>
<p><code>bayesplot</code> allows us to analyze the data we used to estimate the model compared to data produced by the model, or what is called the posterior predictive distribution. This is very useful as a general summary of model fit to see whether there are values of the outcome that we are over or under predicting.</p>
<p><code>idealstan</code> implements functions for each ideal point model that calculate the log-posterior probability of the data, which is the necessary input to use <code>loo</code>’s model evaluation features. This vignette demonstrates the basic usage. I also discuss best practices for evaluating models.</p>
<p>We first begin by simulating data for a standard IRT 2-PL ideal point model but with strategically missing data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">irt_2pl &lt;-<span class="st"> </span><span class="kw">id_sim_gen</span>(<span class="dt">inflate=</span><span class="ot">TRUE</span>)</code></pre></div>
<p>We can then fit two ideal point models to the same data, one that uses the correct binomial model for a 0/1 binary outcome, and the second that tries to fit a Poisson count model to this same binary data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Because of CRAN limitations, only using 2 cores &amp; 2 chains</span>
irt_2pl_correct &lt;-<span class="st"> </span><span class="kw">id_estimate</span>(<span class="dt">idealdata=</span>irt_2pl,
                               <span class="dt">model_type=</span><span class="dv">2</span>,
                               <span class="dt">restrict_ind_high =</span> <span class="kw">as.character</span>(<span class="kw">sort</span>(irt_2pl<span class="op">@</span>simul_data<span class="op">$</span>true_person,
                                                        <span class="dt">decreasing=</span><span class="ot">TRUE</span>,
                                                        <span class="dt">index=</span><span class="ot">TRUE</span>)<span class="op">$</span>ix[<span class="dv">1</span>]),
                              <span class="dt">restrict_ind_low =</span> <span class="kw">as.character</span>(<span class="kw">sort</span>(irt_2pl<span class="op">@</span>simul_data<span class="op">$</span>true_person,
                                                      <span class="dt">decreasing=</span><span class="ot">FALSE</span>,
                                                        <span class="dt">index=</span><span class="ot">TRUE</span>)<span class="op">$</span>ix[<span class="dv">1</span>]),
                               <span class="dt">fixtype=</span><span class="st">'vb_partial'</span>,
                           <span class="dt">ncores=</span><span class="dv">2</span>,
                           <span class="dt">nchains=</span><span class="dv">2</span>,
                           <span class="dt">niters =</span> <span class="dv">500</span>)</code></pre></div>
<pre><code>## Chain 1: Gradient evaluation took 0 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0 seconds.
## Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)
## Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)
## Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)
## Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)
## Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)
## Chain 1: Success! Found best value [eta = 1] earlier than expected.
## Chain 1:    100        -1087.696             1.000            1.000
## Chain 1:    200        -1083.562             0.502            1.000
## Chain 1:    300        -1078.742             0.336            0.004   MEDIAN ELBO CONVERGED
## Chain 1: Drawing a sample of size 1000 from the approximate posterior...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">irt_2pl_incorrect &lt;-<span class="st"> </span><span class="kw">id_estimate</span>(<span class="dt">idealdata=</span>irt_2pl,
                               <span class="dt">model_type=</span><span class="dv">8</span>,
                            <span class="dt">restrict_ind_high =</span> <span class="kw">as.character</span>(<span class="kw">sort</span>(irt_2pl<span class="op">@</span>simul_data<span class="op">$</span>true_person,
                                                        <span class="dt">decreasing=</span><span class="ot">TRUE</span>,
                                                        <span class="dt">index=</span><span class="ot">TRUE</span>)<span class="op">$</span>ix[<span class="dv">1</span>]),
                            <span class="dt">restrict_ind_low =</span> <span class="kw">as.character</span>(<span class="kw">sort</span>(irt_2pl<span class="op">@</span>simul_data<span class="op">$</span>true_person,
                                                      <span class="dt">decreasing=</span><span class="ot">FALSE</span>,
                                                        <span class="dt">index=</span><span class="ot">TRUE</span>)<span class="op">$</span>ix[<span class="dv">1</span>]),
                            <span class="dt">fixtype=</span><span class="st">'vb_partial'</span>,
                           <span class="dt">ncores=</span><span class="dv">2</span>,
                           <span class="dt">nchains=</span><span class="dv">2</span>,
                           <span class="dt">niters=</span><span class="dv">500</span>)</code></pre></div>
<pre><code>## Chain 1: Gradient evaluation took 0.001 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 10 seconds.
## Chain 1: Iteration:   1 / 250 [  0%]  (Adaptation)
## Chain 1: Iteration:  50 / 250 [ 20%]  (Adaptation)
## Chain 1: Iteration: 100 / 250 [ 40%]  (Adaptation)
## Chain 1: Iteration: 150 / 250 [ 60%]  (Adaptation)
## Chain 1: Iteration: 200 / 250 [ 80%]  (Adaptation)
## Chain 1: Iteration: 250 / 250 [100%]  (Adaptation)
## Chain 1: Success! Found best value [eta = 0.1].
## Chain 1:    100        -5379.282             1.000            1.000
## Chain 1:    200        -3155.587             0.852            1.000
## Chain 1:    300        -2064.722             0.744            0.705
## Chain 1:    400        -1823.771             0.591            0.705
## Chain 1:    500        -1723.987             0.485            0.528
## Chain 1:    600        -1691.169             0.407            0.528
## Chain 1:    700        -1663.264             0.351            0.132
## Chain 1:    800        -1650.297             0.308            0.132
## Chain 1:    900        -1644.033             0.275            0.058
## Chain 1:   1000        -1635.476             0.248            0.058
## Chain 1:   1100        -1628.395             0.148            0.019
## Chain 1:   1200        -1625.859             0.078            0.017
## Chain 1:   1300        -1619.546             0.025            0.008   MEDIAN ELBO CONVERGED
## Chain 1: Drawing a sample of size 1000 from the approximate posterior...</code></pre>
<p>The first thing we want to check with any MCMC model is convergence. An easy way to check is by looking at the Rhat distributions. If all these values are below 1.1, then we have good reason to believe that the model converged, and we can get these distributions with the <code>id_plot_rhats</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">id_plot_rhats</span>(irt_2pl_correct)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">id_plot_rhats</span>(irt_2pl_incorrect)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAtFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshZWVlmAABmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQkGaQ27aQ2/+rbk2rbm6rjk2ryKur5OSr5P+2ZgC22/+2///Ijk3I///bkDrb/7bb///kq27k////tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///9SF1JkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGSUlEQVR4nO3dCVfaWByG8aAwlbajODO1s+AUZ5FRqYrM4HK///ea3CQIUcKbDUzzf55zWnus5KS/ZruBC4GjjQVvvQJNDyARQCKARACJABIBJAJIBJAIIBFAIoBEAIkAEgEkAkhUF9BhXE1La1AAiQASVQY6TFXHKjUrgEQAiQASASQCSASQCCARQCKARACJABIBJAJIBJAIIBFAIoBEAIkAEgEkAkgEkAggEUAigEQAiQASASQCSASQCCARQCKARACJABIBJAJIBJAIINEGoKez/vtz5x4+9z/eZv+UYaDLobv7ePt0NnQ332f/lF2gh1+uFl/mP15l/phdoPmnP/0uNv906x5+Ps/8McNAx0OvE+5lAK0t2XTYgrJ6+C2S4RiU2WW0iz2dnXAWW194AfThiuugqgsASASQCCARQCKAsjpcV41r1pAAEgEkAkgEkAggEUAigEQAiQASASQCSASQKAV0fzS4Pwr2LnI90iLQuOsmexeTbq5HGgQKN6DH066b5tuEbALdHx0AlGoV6PH0YNoZ+R0tT2uB2ueUOgbNekHXjfevcz3SIlChDAI9ng4KPNIgUHiQLvBIg0BukvPwE2UQKLyKjqpwmm83ULEAEpkEmgTBIO+ByCLQeP9rPBzLk0GgaCw2qDQWA2iZQaDwOuhrPKDPk0UgN/WXQfl8bAIVySBQMhbjGLQaQKIl0CRYxHXQStzuEHGQFjEWEzEWEzHUEAEk2jgW81PCM+eLWQR6ORa76Q9d5rx5k0Dp5j/9OsyeNw/Q0x9/nw2z581bBJr1Vp/2uTnxu1fmvHmDQOkroGjGM1tQ9ljspu874Ri07NWLF/wWlDlv3iDQq0tEroM2HqRFBoEeT3Per48yCFTfDbMWOW3nFWYtBXKzd/leZB9lEKi+F1C1FKhYAIksAtV2HdRSoPA6KDyR5T3ZGwTyNOMDN833vI9RoEm16VDtBvLzfEKdnM8cWgTyg7Fx0BnleqRFoEIZBGIstiZG86LtzPZpKRCD1TVxkBYBJGKwKmKwKmKwKmKwKmKwKmKwKuI0LwJItAI0znsFFGcOyL8tzqSAUA6gNnA9A0U3g4rcEbIGFF1AF3kBDEAigEQAiewBPc9ZrW0s1iqgwgEkAkgEkAggEUAigEQAiQASASQCaH7c75ecL2YCyE9Unf9wXmrevAmgO69yOSw1Z9UEkG/Tp4UD5KIJvaXmzRsBevh84srNm7cBND8Oz2Hl3rvDBFDsU27evAmg+J0XhlwHlQ0gEUAigEQAiQASASQCSASQCCARQCKARACJABIBJAJIBJAIIBFAIoBEAIkAEgEk2gpQ8ywBEgEkAkgEkAgg0e6BNnoBBBBAi6oCrbUACKCSbOmFVvxH1RlAIoBETQHa9M3K/8gqASQCSPQNAb0NF0AigETfAtDav9tVAIkAEgEkAkikgWqbL1YAKP8DamLI1pdA9c2bbylQfXNWWwqUOevZSBIoc968kdiCROWPQUbKcRbLmDdvpPLXQUYqfyVtJIBEAIkAEgEkAkgEkAggEUAigEQAiQASASQCSFQv0OLOWnKLpOydkheLcWXv2L1YTvL+z8WqFeiu/yFao+SposxnjIotZvmNastJ3v+54ELqBLp8/1f8X5bcpi15t/blYpbfqLac5P2fCy5lK7tYcqO/9P3+9GJc1V1sZT2Kr85WgJKniko/Y5RejKsKtFyOv8FeMFNbUPT+zwXbClC1Y9DLxbiqQIvlJO9vXKytACVPFZV+xii9GFcVKFlOKZ8tAPlfNVwHrSymEtByOYv3fy4WV9IigEQAiQASASQCSASQqGlAj6fxpwUfODf7bpT+u3//eYMVah5Q9GnTs97gFdArsJ3UUCA37gK0thTQ7+G+NvCbk9/n/O8H8Z8HO1yhhgJNQ4RZb//aTfYuog96D7/6LSjaivz+t7OaBxQfpAeJQyjy37WLvkZA73J91HuNNQ/In796fjOKtxb/2zQU60RAbhwE3Z2uUCOBoj3sGej+qDNabEFh90fB3g43o2YCuXFosACahociN+2Mns9i0UFpVzUUaNbrLoH8BtTrjLzL1G88Oz3fNxTITcLz+uIYFB53Ol9CnXF4+IkPRztcoaYBNS6ARACJABIBJAJIBJAIIBFAIoBE/wN9G6+qf0lpVgAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<p>We can only assume that the first model will converge. If the second model failed the Rhat test, at this point we should go back and see if the model is miss-specified or there is something wrong with the data. But for the sake of illustration, we will look at other diagnostics. We can also examine whether 1) the models are able to replicate the data they were fitted on accurately and 2) overall measures of model fit.</p>
<p>We can first look at how well the model reproduces the data, which is called the posterior predictive distribution. We can obtain these distributions using the <code>id_post_pred</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">post_correct &lt;-<span class="st"> </span><span class="kw">id_post_pred</span>(irt_2pl_correct)</code></pre></div>
<pre><code>## [1] &quot;Processing posterior replications for 1000 scores using 100 posterior samples out of a total of 500 samples.&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">post_incorrect &lt;-<span class="st"> </span><span class="kw">id_post_pred</span>(irt_2pl_incorrect)</code></pre></div>
<pre><code>## [1] &quot;Processing posterior replications for 1000 scores using 100 posterior samples out of a total of 500 samples.&quot;</code></pre>
<p>What we can do is the use a wrapper around the <code>bayesplot</code> package called <code>id_plot_ppc</code> to see how well these models replicate their own data. These plots show the original data as blue bars and the posterior predictive estimate as an uncertainty interval. If the interval overlaps with the observed data, then the model was able to replicate the observed data, which is a basic and important validity test for the model, i.e., could the model have generated the data that was used to fit it?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">id_plot_ppc</span>(irt_2pl_correct,<span class="dt">ppc_pred=</span>post_correct)</code></pre></div>
<pre><code>## Warning in is.na(group): is.na() applied to non-(list or vector) of type 'NULL'</code></pre>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA9lBMVEUAAAAAADoAAGYAOpAAZrYBH0szMzM6AAA6ADo6AGY6OmY6OpA6ZrY6kLw6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOpBmZrZmkNtmtv9uTU1uTY5ubqtuq+SOTU2OTW6OTY6ObquOq+SOyP+QOgCQOjqQOmaQZpCQkDqQkJCQkLaQkNuQ2/+rbk2rbo6rjk2rq8ir5P+zzeC2ZgC2Zjq2Zma2tma2///Ijk3Ijo7Iq6vI///R4ezbkDrbkGbbkJDb25Db/9vb///kq27kq47k////tmb/tpD/yI7/yKv/25D/5Kv//7b//8j//9v//+T////fOXdpAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAH+ElEQVR4nO2daUPbNgCGw+HubtbSsa6s6VrCTsoGZFthjB2kSTNy6f//mVk+EkuW/cqO3fh4nw8pVfW60YMiS8YyHUFS6Wz7DVQdCgJQEICCABQEoCBALkFtskpBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQoBaCHOc9/4cRKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgLUQZDjbNFQDQQ5zjYNVV+Q42zVUOUFOc52DVEQgIIAFASovCAO0hCe5hEVnihe9YWYHn1+Eb5ahYqnskuN6VFfzL+5mH59479ahUqgsoL++KUvJgdiedb3X61CJVBVQZO++xEbHriftJ7/KgsfuBQhKEujKypoeS7HoGHPE9QLBYGQNQ0Q9N8FBaW29arr0itrDGqAIOGd5uX56/nIf7UL2dEYQWXNg5ohqMiQBgWlk7J8uIzhOPGyy8vN34QNWxKUtgC9/NOKRgtKvYRBQeAiGAVREIKCABSE4CCN4GkekTZRpCBJ8vKhlYKyLB/aKSjWPsdJajQFUVAcCgJQEICCABQEoCAABQEoCJCl0RREQXEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEKCZgobd9T6fDXf7NFLQ9FhuWC1m13MjBblMegXtem6ooOW5KGjXczMFzV90ewVt6m2mILf7PLqhoDTmL284BqUxOSho13MjBQ27XXdo5jzovYQoCEBBAAoCUBCAggDbFLTZgy0oCEBBAAoCNF+QcX/1oLPzWojbvTsYV9o6O5Wvt88yhazYnqCEHfqzJw+FePfxG5g3CJodoliNBCU942Fxsu+29Cd8gEhbx52A/QwhS7YlaP0QDN3QwG3l37gDqW29/8quubUR5DiJhgZ7d1bNbfYgnSLodu9f7wM2O/xh5/Wgs3c3O/y903lo1VbY8xohaPdH2czFiStl/FAMPjtxh5b7D2InKLWtt94YtNsGQWN5nhf+KUk2e987N93GupB6FvvCC7WiB42DvuIJehZ8gQQtvrMY1vWQFZU7i60GaOllvC9mT2XvCHpIclv9iVBzelDCPGj8yT+n4ddyfHZfdt/MnnQ6OzE/Wg86adgYJMwz6fGO4QSfMD9W2/pXw8YgScqzrhSsBFnih0zP/ynimUDbWc27nx7j0tUgCE8wA0ElNbrClzvkOOUCLwLUS9BmGFbzeAnXWkE+sy/Zg/S2Ktx/ZHcWa6GgYAyKL2mNoTYKOk2qZgq1UFC2kKEhpmfeNEuQXPjDa/YtFiQv1IpB/jGo6YJmT70/LNdibRTkD9K/UZDe1hC5mvd+YmQTaqMg74IQHIISBckLC80WlCkUa4h/aYqCkgSFFzcbKkguM+Tgs/g2fl3WHNIasr48XglByRfvcgoS42CGeP8hNFQLQTky6YJ+Db3cf0pBBkHBJFHY/HSsnYLWK/mcE8VqDdKFC1qsbiZafJ/zimKlTvPFj0HvwjFoHMwUl2fpu56rPVFMF5TnHsVwiTEIVxpvL8TV41HyrudqLzVAD8p1j6J/D170cpArJXnHYa0F5blH0cD0+Sh513OtBeW7RzHGJG3Xc80FFXGP4vzVqLGCwnsUNxJ0fSNSnrxQ7Z9qQEH+PYobCRr2xfQ4eddzvQWNDTdLZRQkf1u4O/nJMA+qlSD8wxskCIVqLcj2nvl2Coreo0hBJkGmexQpCGeS25orREEgREEgVHFBhV+0zxyqtqCioCCrtuYKURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIURAIUZD3O1brupmlKFK3Q8nfcZhpU2/LBHk9qK4b6ooCCsq0qbeVgrLsWaWgaIiCOAYJC0F13dRbFGmCJt7vMuY8KG+IgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgkCIgqJwt0863PUM4I5DgLbr2cV7iZGhdOMDeKVluvGwFaRs6pU8MNbLULrxARJKC4aCALnGIAkFKai7nttErnlQmyj/NFBzKAhAQQAKAmQXtBqu5y+6j1bLM/9xXkIfzcPSSN3lWTeoEa26LlUOOzTVXZeqb6EUMgtaL1vfRk9r3uO8hL6qDUujdd0vrx6P9KqrUuWw0+NAsVJ3Vaq+hXLILGg1ZXS/e9GpdfCWtRllUKrV9duqTz79Uq2qmPQMhw1K9bplkFnQetnqdvueWq7+c6RUq+vPObWqIpyJKlWX56bDBqVa3VLILiiyKpu/jI1B2qJtJUip63//9fXdpBevGvYRtW6k50QPWwobCRLX9oIideevRoaqQal2WDH0RmFd5nA1Nl9XTVB0NFj+HBNkHoPUukGbtKrrlkYPG3QRfQxadRylbhnkOouFy9ZJfAzSVrVrQeu6w748D+lVw1LtsFJN/LBBqV63DHLOg6ZHff8BXiHe39xSdcISlkbrXnW77jRGr7oqVQ47DB4SptZdlapvoRw4kwZQEICCABQEoCAABQEoCEBBAAoCUBDgf9X83jQtvt6PAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">id_plot_ppc</span>(irt_2pl_incorrect,<span class="dt">ppc_pred=</span>post_incorrect)</code></pre></div>
<pre><code>## Warning in is.na(group): is.na() applied to non-(list or vector) of type 'NULL'</code></pre>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>It is stupidly obvious from these plots that one should not use a Poisson distribution for a Bernoulli (binary) outcome as it will predict values as high as 10 (although it still puts the majority of the density on 1 and 2). Only two observed values are showing on the Poisson predictive distribution because the missing data model must be shown separately if the outcome is unbounded. To view the missing data model (i.e., a binary response), simply change the <code>output</code> option in <code>id_post_pred</code> to <code>'missing'</code>. We can also look at particular persons or items to see how well the models predict those persons or items. For example, let’s look at the first two persons in the simulated data for which we incorrectly used the Poisson model by passing their IDs as a character vector to the <code>group</code> option:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">id_plot_ppc</span>(irt_2pl_incorrect,<span class="dt">ppc_pred=</span>post_incorrect,<span class="dt">group=</span><span class="kw">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>))</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Finally, we can turn to summary measures of model fit that also allow us to compare models directly to each other (if they were fit on the same data). To do so, I first employ the <code>log_lik</code> option of the <code>id_post_pred</code> function to generate log-likelihood values for each of these models. I also need to create exponentiated log-likelihood values (setting <code>type='log_lik_eff'</code>), which are necessary to calculate the effective number of samples in evaluating model fit.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">log_lik_irt_2pl_correct &lt;-<span class="st"> </span><span class="kw">id_post_pred</span>(irt_2pl_correct,<span class="dt">type=</span><span class="st">'log_lik'</span>)</code></pre></div>
<pre><code>## [1] &quot;Processing posterior replications for 1000 scores using 500 posterior samples out of a total of 500 samples.&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">log_lik_irt_2pl_incorrect &lt;-<span class="st"> </span><span class="kw">id_post_pred</span>(irt_2pl_incorrect,<span class="dt">type=</span><span class="st">'log_lik'</span>)</code></pre></div>
<pre><code>## [1] &quot;Processing posterior replications for 1000 scores using 500 posterior samples out of a total of 500 samples.&quot;</code></pre>
<p>With this calculation can examine the models’ <code>loo</code> values, which shows the relative predictive performance of the model to the data. Overall, model performance seems quite good, as the Pareto k values show that there are only a few dozen observations in the dataset that aren’t well predicted. The LOO-IC, or the leave-one-out information criterion (think AIC or BIC), are also similar for the two models, although the correct model does have a lower (i.e., better) LOO-IC.</p>
<p>Note that we must also specify the <code>relative_eff</code> function in order to calculate degrees of freedom. The first argument to <code>relative_eff</code> is the exponentiated log-likelihood matrix we calculated previously. The second argument uses the function <code>derive_chain</code> and also takes the log-likelihood matrix as its argument.</p>
<p>I put in an option for two cores, but a larger number could be used which would improve the precision of the calculations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">correct_loo &lt;-<span class="st"> </span><span class="kw">loo</span>(log_lik_irt_2pl_correct,
                   <span class="dt">cores=</span><span class="dv">2</span>,
                   <span class="dt">r_eff=</span><span class="kw">relative_eff</span>(<span class="kw">exp</span>(log_lik_irt_2pl_correct),
                                      <span class="dt">chain_id=</span><span class="kw">derive_chain</span>(log_lik_irt_2pl_correct)))</code></pre></div>
<pre><code>## Warning: Some Pareto k diagnostic values are too high. See help('pareto-k-diagnostic') for details.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">incorrect_loo &lt;-<span class="st"> </span><span class="kw">loo</span>(log_lik_irt_2pl_incorrect,
                     <span class="dt">cores=</span><span class="dv">2</span>,
                     <span class="dt">r_eff=</span><span class="kw">relative_eff</span>(<span class="kw">exp</span>(log_lik_irt_2pl_incorrect),
                                      <span class="dt">chain_id=</span><span class="kw">derive_chain</span>(log_lik_irt_2pl_incorrect)))</code></pre></div>
<pre><code>## Warning: Some Pareto k diagnostic values are slightly high. See help('pareto-k-diagnostic') for details.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(correct_loo)</code></pre></div>
<pre><code>## 
## Computed from 500 by 1000 log-likelihood matrix
## 
##          Estimate   SE
## elpd_loo   -691.4 14.0
## p_loo       116.2  3.7
## looic      1382.9 28.1
## ------
## Monte Carlo SE of elpd_loo is NA.
## 
## Pareto k diagnostic values:
##                          Count Pct.    Min. n_eff
## (-Inf, 0.5]   (good)     948   94.8%   109       
##  (0.5, 0.7]   (ok)        49    4.9%   72        
##    (0.7, 1]   (bad)        3    0.3%   102       
##    (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
## See help('pareto-k-diagnostic') for details.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(incorrect_loo)</code></pre></div>
<pre><code>## 
## Computed from 500 by 1000 log-likelihood matrix
## 
##          Estimate   SE
## elpd_loo  -1065.1 12.2
## p_loo        39.1  2.3
## looic      2130.2 24.4
## ------
## Monte Carlo SE of elpd_loo is 0.4.
## 
## Pareto k diagnostic values:
##                          Count Pct.    Min. n_eff
## (-Inf, 0.5]   (good)     992   99.2%   137       
##  (0.5, 0.7]   (ok)         8    0.8%   143       
##    (0.7, 1]   (bad)        0    0.0%   &lt;NA&gt;      
##    (1, Inf)   (very bad)   0    0.0%   &lt;NA&gt;      
## 
## All Pareto k estimates are ok (k &lt; 0.7).
## See help('pareto-k-diagnostic') for details.</code></pre>
<p>We can also compare the LOOIC of the two models explicitly using a second <code>loo</code> function that will even give us a confidence interval around the difference. If the difference is negative, then the first (correct) model has higher predictive accuracy:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">compare</span>(correct_loo,
        incorrect_loo)</code></pre></div>
<pre><code>## elpd_diff        se 
##    -373.7      13.2</code></pre>
<p>The first (correct) model is clearly preferred, as we would certainly hope in this extreme example. In less obvious cases, the <code>elpd</code> values can help arbitrate between model choices when a theoretical reason for choosing a model does not exist.</p>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
